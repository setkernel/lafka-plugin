!function(i){"use strict";function _(a,e,o,n){null!==a&&(a.value="",document.getElementById("lafka_branch_distance_restriction").value=""),e.value="",n.setMap(null),o.setCenter(new google.maps.LatLng("0","0")),o.setZoom(2)}function d(e,o,a,n,t,r){_(e,o,n,t),a.geocode(r).then(a=>{a=a.results;return"APPROXIMATE"===a[0].geometry.location_type?alert(lafka_branch_location_properties.geocode_approximate):(s(n,t,a[0].geometry.location),e.value=a[0].formatted_address,o.value=encodeURIComponent(JSON.stringify(a[0].geometry.location))),a}).catch(a=>{alert(lafka_branch_location_properties.geocode_error+": "+a)})}function s(a,e,o){a.setCenter(o),a.setZoom(10),e.setPosition(o),e.setMap(a)}function u(){i("#lafka_branch_location_img").find("img").attr("src",lafka_branch_location_properties.placeholder_image_src),i("#lafka_branch_location_img_id").val(""),i(".lafka_branch_location_img_remove_image_button").hide()}i(document).ajaxComplete(function(a,e,o){const n=new URLSearchParams(o.data);if("edit-lafka_branch_location"===n.get("screen")){_(document.getElementById("lafka_branch_address"),document.getElementById("lafka_branch_address_geocoded"),window.lafka_branch_location_map,window.branch_location_map_marker),u(),i(document).find("#lafka_branch_user").val(null).trigger("change");const t=i(document).find("#lafka_branch_order_type"),r=(t.val(t.find("option:first").val()),i(document).find("#lafka_branch_shipping_areas").val(null).trigger("change"),i(document).find("#lafka_branch_distance_restriction").val(""),i(document).find("#lafka_branch_distance_unit")),c=(r.val(r.find("option:first").val()),i(document).find("#lafka_branch_override_datetime_global").prop("checked",!1).trigger("change"),i(document).find("#lafka_branch_datetime_mandatory").prop("checked",!1).trigger("change"),i(document).find("#lafka_branch_datetime_days_ahead").val("30"),i(document).find("#lafka_branch_datetime_timeslot_duration").val("60"),i(document).find("#lafka_branch_override_order_hours_global").prop("checked",!1).trigger("change"),i(document).find("#lafka_branch_timezone").val("default").trigger("change"),i(document).find("#lafka_branch_order_hours_force_override_check").prop("checked",!1),i(document).find("#lafka_branch_order_hours_force_override_status")),l=(c.val(c.find("option:first").val()),i(document).find("#lafka_branch_order_hours_schedule").val(""),i(document).find("#lafka_branch_order_hours_container").jqs("reset"),i(document).find("#lafka_branch_order_hours_holidays_calendar"));l.length&&l.flatpickr({mode:"multiple"}).clear()}}),window.addEventListener("DOMContentLoaded",function(){var a;!function(e,o){var a=document.getElementById("lafka_geocode_branch_location_map");if(null===a)return;void 0===e&&(e=new google.maps.Map(a,{center:new google.maps.LatLng("0","0"),zoom:2,mapTypeControl:!1}),window.lafka_branch_location_map=e);const n=new google.maps.Geocoder,t=document.getElementById("lafka_branch_address"),r=document.getElementById("lafka_branch_address_geocoded"),c=document.createElement("input"),l=(c.type="button",c.value=lafka_branch_location_properties.geocode_label,c.classList.add("lafka-geocode-branch-button","lafka-geocode-branch-address-submit"),document.createElement("input"));l.type="button",l.value=lafka_branch_location_properties.clear_label,l.classList.add("lafka-geocode-branch-button","lafka-geocode-branch-address-clear"),e.controls[google.maps.ControlPosition.TOP_LEFT].push(t),e.controls[google.maps.ControlPosition.TOP_LEFT].push(c),e.controls[google.maps.ControlPosition.TOP_LEFT].push(l),void 0===o&&(o=new google.maps.Marker({map:e}),window.branch_location_map_marker=o);e.addListener("click",a=>{d(t,r,n,e,o,{location:a.latLng})}),c.addEventListener("click",()=>d(t,r,n,e,o,{address:t.value})),l.addEventListener("click",()=>{_(t,r,e,o)}),t.addEventListener("change",a=>{a.target.value||_(null,r,e,o)}),r.value?(a=JSON.parse(decodeURIComponent(r.value)),s(e,o,new google.maps.LatLng(a.lat,a.lng))):_(t,r,e,o)}(),i("#lafka_branch_location_img_id").val()||i(".lafka_branch_location_img_remove_image_button").hide(),i(document).on("click",".lafka_branch_location_img_upload_image_button",function(a){a.preventDefault();let o;o||(o=wp.media({title:lafka_branch_location_properties.choose_image_label,button:{text:lafka_branch_location_properties.use_image_label},multiple:!1})).on("select",function(){var a=o.state().get("selection").first().toJSON();let e;e=(void 0===a.sizes.thumbnail?a.sizes.full:a.sizes.thumbnail).url,i("#lafka_branch_location_img_id").val(a.id),i("#lafka_branch_location_img").find("img").attr("src",e),i(".lafka_branch_location_img_remove_image_button").show()}),o.open()}),i(document).on("click",".lafka_branch_location_img_remove_image_button",function(){return u(),!1}),i(".lafka-admin-select2").select2(),i("#autocomplete_countries").select2({maximumSelectionLength:5}),lafka_branch_location_properties.products_by_branches||i(document.body).find("#tagsdiv-lafka_branch_location").hide(),a=function(a){try{var e=JSON.parse(a);if(e&&"object"==typeof e)return e}catch(a){}return[]}(i("#lafka_branch_order_hours_schedule").val()),i(document).find("#lafka_branch_order_hours_container").jqs({data:a,periodOptions:!1}),i(document).find("body.taxonomy-lafka_branch_location form#addtag input:submit, body.taxonomy-lafka_branch_location form#edittag input:submit").on("click",function(a){i(document).find("#lafka_branch_order_hours_schedule").val(i(document).find("#lafka_branch_order_hours_container").jqs("export"))}),i(document).find("#lafka_branch_order_hours_holidays_calendar").flatpickr({mode:"multiple"})})}(window.jQuery);